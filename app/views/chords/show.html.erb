<br/>
<!-- <h1>Your chord</h1> -->
<br/>

<!-- <p><%= @your_chord %></p> -->
<!-- <br/> -->
<div class="chordbox chord5">
	<p>Your current chord is:</p>
		<button class="btn-sm btn-default finger"><span class="suggestion finger" data-chord="<%= @your_chord %>" id="<%= @your_chord %>"><%= @your_chord %></span></button>
		 	<br/>
		<%= audio_tag @your_chord.to_s + ".mp3", controls:"controls", class:"sm-audio hidden" %>
		<br/>
	</div>



<!--  <span class="suggestion finger" data-chord="<%= @suggestion %>"><%= link_to @suggestion %></span>   -->

<div class="chordbox chord4">
	<p>A good following chord for <%= @your_chord %> would be: </p>
		<button class="btn-sm btn-default finger"><span class="suggestion finger" data-chord="<%= @suggestion %>" id="<%= @suggestion %>"><%= @suggestion %></span></button>
		 	<br/>
		<%= audio_tag @suggestion.to_s + ".mp3", controls:"controls", class:"sm-audio hidden" %>
		<br/>
	</div>
 
<br/>
<div class="add"><p> <%= link_to "Add Chord", add_chord_path({chord: @suggestion}) %></p></div><div class="add"><p> <a href="javascript:location.reload();">New suggestion</a></p></div>
<br/>


<p>Your chord progression so far is: </p>
<br/>

<div class="progression">
<button class="progress">Play</button>
	<% session[:progression].each do |chord| %>
		<div class="chordbox">
			<button class="btn-sm btn-default finger"><span class="suggestion finger" data-chord="<%= chord %>" id="<%= chord %>"><%= chord %></span></button>
			<%= audio_tag chord+".mp3", controls:"controls", class:"sm-audio hidden prog" %>
		</div>
	<% end %>
</div>
<br/>
<p>Remove Current chord from progression: <%= link_to "Remove", remove_chord_path %> </p>
<br/>
<p><%= link_to "Reset Progression", reset_path %>  <%= link_to "Save Progression", new_progression_path %></p>


<%= render partial: 'piano' %>
<!-- <div id="content">
            <div id="content-inner">
                <div id="piano">
                    <h1 id="cool">Chord Dealer</h1>
                    <div class="help show" tabindex="1">
                        <div class="help-inner">
                            <div id="synth-settings"></div>
                            <div class="opts">
                                <p><strong>Controls:</strong></p>
                                <p>play using home row &amp; above &nbsp; /</p>
                                <p>change playable keys: “,” &amp; “.” &nbsp; /</p>
                                <p>shift keyboard: ← &amp; → <span id="shift"></span></p>
                            </div>
                            <div class="opts">
                                <p><strong>Extras:</strong></p>
                                <p class="toggle-color toggle hold">Color - c &nbsp; /</p>
                                <p class="toggle-demo toggle">Demo - m &nbsp; /</p>
                                <p class="toggle-animate toggle">Visual mode - 8 &nbsp; /</p>
                                <p class="toggle-looper">Looper - 9 &nbsp; /</p>
                                <p>Help - 0</p>
                            </div>
                        </div>
                    </div>
                    <div class="loop" tabindex="2">loop</div>
                </div>
            </div>
        </div> -->

 


<%# image_tag "fingerings/#{@suggestion}.jpg", class:"key-image" %>
<script>
	
	$(function() {
		$(".chordbox").each(function(b) {
		$(this).find(".finger").on("click", function( e ) {
		e.preventDefault
		$(this).closest(".chordbox").find(".sm-audio").get(0).play();
		});
	});

		$(".progress").on("click", function( e ) {
		e.preventDefault

		$(".prog").each(function(delay_length){
		console.log('timeout', delay_length);
		setTimeout(play_audio, delay_length * 1000, this);
	});

	function play_audio(audio) {
		console.log("play", audio);
		audio.play();
	}
	});
		});
</script>